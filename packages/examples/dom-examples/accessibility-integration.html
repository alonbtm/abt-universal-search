<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accessible DOM Search Integration</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: #000;
            color: white;
            padding: 8px;
            text-decoration: none;
            border-radius: 4px;
            z-index: 1000;
        }

        .skip-link:focus {
            top: 6px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: #1565c0;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #1976d2, #42a5f5);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .demo-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid #e3f2fd;
            position: relative;
        }

        .demo-section:focus-within {
            border-color: #1976d2;
            box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.1);
        }

        .demo-section h2 {
            color: #1565c0;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .demo-section h2::before {
            content: "♿";
            font-size: 1.5em;
        }

        .search-container {
            position: relative;
            margin-bottom: 20px;
        }

        .search-input {
            width: 100%;
            padding: 15px 50px 15px 20px;
            border: 2px solid #e3f2fd;
            border-radius: 12px;
            font-size: 1.1rem;
            transition: all 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: #1976d2;
            box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.1);
        }

        .search-button {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: #1976d2;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .search-button:hover {
            background: #1565c0;
        }

        .search-button:focus {
            outline: 2px solid #fff;
            outline-offset: 2px;
        }

        .live-region {
            position: absolute;
            left: -10000px;
            top: auto;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }

        .search-results {
            background: #f8fafc;
            border-radius: 10px;
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #e3f2fd;
        }

        .result-item {
            padding: 15px 20px;
            border-bottom: 1px solid #e3f2fd;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .result-item:hover {
            background-color: #e3f2fd;
        }

        .result-item:focus {
            outline: 2px solid #1976d2;
            outline-offset: -2px;
            background-color: #e3f2fd;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-item.selected {
            background-color: #bbdefb;
            border-left: 4px solid #1976d2;
        }

        .result-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #1976d2, #42a5f5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            flex-shrink: 0;
        }

        .result-content {
            flex: 1;
        }

        .result-title {
            font-weight: 600;
            color: #1565c0;
            margin-bottom: 4px;
        }

        .result-description {
            color: #424242;
            font-size: 0.9rem;
        }

        .result-meta {
            color: #757575;
            font-size: 0.8rem;
            margin-left: auto;
        }

        .control-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .control-group {
            background: #f8fafc;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #e3f2fd;
        }

        .control-group h3 {
            color: #1565c0;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #1976d2;
        }

        .checkbox-item input[type="checkbox"]:focus {
            outline: 2px solid #1976d2;
            outline-offset: 2px;
        }

        .checkbox-item label {
            cursor: pointer;
            user-select: none;
        }

        .filter-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .filter-chip {
            background: #1976d2;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chip-remove {
            background: rgba(255, 255, 255, 0.3);
            border: none;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chip-remove:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        .chip-remove:focus {
            outline: 2px solid white;
            outline-offset: 1px;
        }

        .keyboard-shortcuts {
            background: #f8fafc;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #e3f2fd;
            margin-top: 20px;
        }

        .keyboard-shortcuts h4 {
            color: #1565c0;
            margin-bottom: 15px;
        }

        .shortcuts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
        }

        .shortcut-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
        }

        .shortcut-key {
            background: #e3f2fd;
            padding: 4px 8px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.9rem;
            color: #1565c0;
            font-weight: 600;
        }

        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #e3f2fd;
            border-top: none;
            border-radius: 0 0 12px 12px;
            z-index: 100;
            max-height: 200px;
            overflow-y: auto;
        }

        .suggestion-item {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 1px solid #e3f2fd;
            transition: background-color 0.2s;
        }

        .suggestion-item:hover,
        .suggestion-item.highlighted {
            background-color: #e3f2fd;
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        .status-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #1976d2;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            transform: translateX(100%);
            transition: transform 0.3s;
        }

        .status-indicator.show {
            transform: translateX(0);
        }

        .accessibility-tools {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            border: 2px solid #1976d2;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
        }

        .tool-button {
            background: #1976d2;
            color: white;
            border: none;
            padding: 8px 12px;
            margin: 2px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s;
        }

        .tool-button:hover {
            background: #1565c0;
        }

        .tool-button:focus {
            outline: 2px solid #fff;
            outline-offset: 2px;
        }

        .tool-button.active {
            background: #0d47a1;
        }

        .high-contrast {
            filter: contrast(200%) brightness(150%);
        }

        .large-text {
            font-size: 120% !important;
        }

        .reduced-motion * {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
        }

        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        @media (prefers-high-contrast: active) {
            .demo-section {
                border-color: #000;
            }
            
            .search-input:focus {
                border-color: #000;
            }
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <div class="container" id="main-content">
        <div class="header">
            <h1>Accessible DOM Search Integration</h1>
            <p>Comprehensive accessibility features for inclusive search experiences</p>
        </div>

        <!-- Live Regions for Screen Readers -->
        <div aria-live="polite" class="live-region" id="searchStatus"></div>
        <div aria-live="assertive" class="live-region" id="searchErrors"></div>
        <div aria-live="polite" class="live-region" id="resultCount"></div>

        <!-- Employee Search with Full Accessibility -->
        <div class="demo-section" role="search" aria-labelledby="employee-search-title">
            <h2 id="employee-search-title">Employee Directory Search</h2>
            
            <div class="search-container">
                <label for="employee-search" class="sr-only">Search employees</label>
                <input 
                    type="text" 
                    id="employee-search"
                    class="search-input"
                    placeholder="Search by name, department, or skills..."
                    aria-describedby="search-help"
                    aria-expanded="false"
                    aria-haspopup="listbox"
                    role="combobox"
                    autocomplete="off"
                    spellcheck="false"
                />
                <button 
                    class="search-button" 
                    type="button"
                    aria-label="Search"
                    onclick="accessibilitySearch.performSearch()"
                >
                    🔍
                </button>
                
                <!-- Search Suggestions -->
                <div 
                    class="search-suggestions" 
                    id="search-suggestions"
                    role="listbox"
                    aria-label="Search suggestions"
                    style="display: none;"
                ></div>
            </div>
            
            <div id="search-help" class="sr-only">
                Use arrow keys to navigate suggestions, Enter to select, Escape to close.
            </div>

            <!-- Search Results -->
            <div 
                class="search-results" 
                id="search-results"
                role="region"
                aria-label="Search results"
                aria-describedby="result-count-display"
            ></div>
            
            <div id="result-count-display" class="sr-only"></div>
        </div>

        <!-- Advanced Filters with Accessibility -->
        <div class="demo-section" role="group" aria-labelledby="filters-title">
            <h2 id="filters-title">Accessible Search Filters</h2>
            
            <div class="control-panel">
                <fieldset class="control-group">
                    <legend>Departments</legend>
                    <div class="checkbox-group" role="group" aria-labelledby="departments-legend">
                        <div class="checkbox-item">
                            <input type="checkbox" id="dept-engineering" value="Engineering" />
                            <label for="dept-engineering">Engineering</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="dept-design" value="Design" />
                            <label for="dept-design">Design</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="dept-marketing" value="Marketing" />
                            <label for="dept-marketing">Marketing</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="dept-sales" value="Sales" />
                            <label for="dept-sales">Sales</label>
                        </div>
                    </div>
                </fieldset>

                <fieldset class="control-group">
                    <legend>Experience Level</legend>
                    <div class="checkbox-group" role="group" aria-labelledby="experience-legend">
                        <div class="checkbox-item">
                            <input type="checkbox" id="exp-junior" value="Junior" />
                            <label for="exp-junior">Junior (0-2 years)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="exp-mid" value="Mid" />
                            <label for="exp-mid">Mid-level (3-5 years)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="exp-senior" value="Senior" />
                            <label for="exp-senior">Senior (6+ years)</label>
                        </div>
                    </div>
                </fieldset>

                <fieldset class="control-group">
                    <legend>Skills</legend>
                    <div class="checkbox-group" role="group" aria-labelledby="skills-legend">
                        <div class="checkbox-item">
                            <input type="checkbox" id="skill-js" value="JavaScript" />
                            <label for="skill-js">JavaScript</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="skill-react" value="React" />
                            <label for="skill-react">React</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="skill-nodejs" value="Node.js" />
                            <label for="skill-nodejs">Node.js</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="skill-python" value="Python" />
                            <label for="skill-python">Python</label>
                        </div>
                    </div>
                </fieldset>
            </div>

            <!-- Active Filters -->
            <div 
                class="filter-chips" 
                id="active-filters"
                role="group"
                aria-label="Active filters"
            ></div>
        </div>

        <!-- Keyboard Shortcuts Guide -->
        <div class="demo-section">
            <h2>Keyboard Navigation Guide</h2>
            <div class="keyboard-shortcuts">
                <h4>Available Keyboard Shortcuts</h4>
                <div class="shortcuts-grid">
                    <div class="shortcut-item">
                        <span>Navigate results</span>
                        <span class="shortcut-key">↑ ↓</span>
                    </div>
                    <div class="shortcut-item">
                        <span>Select result</span>
                        <span class="shortcut-key">Enter</span>
                    </div>
                    <div class="shortcut-item">
                        <span>Close suggestions</span>
                        <span class="shortcut-key">Escape</span>
                    </div>
                    <div class="shortcut-item">
                        <span>Focus search</span>
                        <span class="shortcut-key">Ctrl + /</span>
                    </div>
                    <div class="shortcut-item">
                        <span>Clear search</span>
                        <span class="shortcut-key">Ctrl + K</span>
                    </div>
                    <div class="shortcut-item">
                        <span>Toggle filters</span>
                        <span class="shortcut-key">Ctrl + F</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Status Indicator -->
    <div class="status-indicator" id="status-indicator">
        <span id="status-text">Ready</span>
    </div>

    <!-- Accessibility Tools -->
    <div class="accessibility-tools">
        <h4 style="margin-bottom: 10px; color: #1976d2;">Accessibility Tools</h4>
        <button class="tool-button" onclick="accessibilitySearch.toggleHighContrast()" aria-label="Toggle high contrast mode">
            High Contrast
        </button>
        <button class="tool-button" onclick="accessibilitySearch.toggleLargeText()" aria-label="Toggle large text">
            Large Text
        </button>
        <button class="tool-button" onclick="accessibilitySearch.toggleReducedMotion()" aria-label="Toggle reduced motion">
            Reduced Motion
        </button>
        <button class="tool-button" onclick="accessibilitySearch.announceInstructions()" aria-label="Repeat instructions">
            Instructions
        </button>
    </div>

    <script>
        class AccessibilitySearch {
            constructor() {
                this.employees = [];
                this.filteredResults = [];
                this.selectedResultIndex = -1;
                this.activeFilters = new Set();
                this.searchInput = document.getElementById('employee-search');
                this.resultsContainer = document.getElementById('search-results');
                this.suggestionsContainer = document.getElementById('search-suggestions');
                this.selectedSuggestionIndex = -1;
                this.suggestions = [];
                
                this.init();
            }

            init() {
                this.generateEmployees();
                this.setupEventListeners();
                this.setupKeyboardShortcuts();
                this.announcePageLoad();
                this.setupFilterListeners();
            }

            generateEmployees() {
                const departments = ['Engineering', 'Design', 'Marketing', 'Sales'];
                const levels = ['Junior', 'Mid', 'Senior'];
                const skills = ['JavaScript', 'React', 'Node.js', 'Python', 'TypeScript', 'CSS', 'HTML', 'Vue.js'];
                const firstNames = ['Alice', 'Bob', 'Carol', 'David', 'Emma', 'Frank', 'Grace', 'Henry', 'Iris', 'Jack'];
                const lastNames = ['Johnson', 'Smith', 'Williams', 'Brown', 'Davis', 'Miller', 'Wilson', 'Moore', 'Taylor', 'Anderson'];

                for (let i = 0; i < 100; i++) {
                    const firstName = firstNames[Math.floor(Math.random() * firstNames.length)];
                    const lastName = lastNames[Math.floor(Math.random() * lastNames.length)];
                    const department = departments[Math.floor(Math.random() * departments.length)];
                    const level = levels[Math.floor(Math.random() * levels.length)];
                    const employeeSkills = skills.sort(() => 0.5 - Math.random()).slice(0, Math.floor(Math.random() * 4) + 2);
                    
                    this.employees.push({
                        id: i + 1,
                        name: `${firstName} ${lastName}`,
                        department,
                        level,
                        skills: employeeSkills,
                        email: `${firstName.toLowerCase()}.${lastName.toLowerCase()}@company.com`,
                        experience: `${Math.floor(Math.random() * 10) + 1} years`
                    });
                }
            }

            setupEventListeners() {
                this.searchInput.addEventListener('input', this.debounce((e) => {
                    this.handleSearch(e.target.value);
                }, 300));

                this.searchInput.addEventListener('keydown', (e) => {
                    this.handleSearchKeydown(e);
                });

                this.searchInput.addEventListener('focus', () => {
                    this.showSuggestions();
                });

                this.searchInput.addEventListener('blur', () => {
                    setTimeout(() => this.hideSuggestions(), 150);
                });

                this.resultsContainer.addEventListener('keydown', (e) => {
                    this.handleResultsKeydown(e);
                });
            }

            setupFilterListeners() {
                const checkboxes = document.querySelectorAll('input[type="checkbox"]');
                checkboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', (e) => {
                        this.handleFilterChange(e.target);
                    });
                });
            }

            handleFilterChange(checkbox) {
                const filterType = checkbox.closest('fieldset').querySelector('legend').textContent;
                const filterValue = checkbox.value;
                
                if (checkbox.checked) {
                    this.activeFilters.add(`${filterType}:${filterValue}`);
                    this.addFilterChip(filterType, filterValue);
                } else {
                    this.activeFilters.delete(`${filterType}:${filterValue}`);
                    this.removeFilterChip(filterType, filterValue);
                }
                
                this.applyFilters();
                this.announceFilterChange(filterType, filterValue, checkbox.checked);
            }

            addFilterChip(type, value) {
                const container = document.getElementById('active-filters');
                const chip = document.createElement('div');
                chip.className = 'filter-chip';
                chip.setAttribute('data-filter', `${type}:${value}`);
                chip.innerHTML = `
                    <span>${value}</span>
                    <button 
                        class="chip-remove" 
                        onclick="accessibilitySearch.removeFilter('${type}', '${value}')"
                        aria-label="Remove ${value} filter"
                    >×</button>
                `;
                container.appendChild(chip);
            }

            removeFilterChip(type, value) {
                const chip = document.querySelector(`[data-filter="${type}:${value}"]`);
                if (chip) chip.remove();
            }

            removeFilter(type, value) {
                const checkbox = document.querySelector(`input[value="${value}"]`);
                if (checkbox) {
                    checkbox.checked = false;
                    this.handleFilterChange(checkbox);
                }
            }

            applyFilters() {
                if (this.activeFilters.size === 0) {
                    this.performSearch(this.searchInput.value);
                    return;
                }

                let filtered = this.filteredResults.length > 0 ? this.filteredResults : this.employees;
                
                this.activeFilters.forEach(filter => {
                    const [type, value] = filter.split(':');
                    filtered = filtered.filter(employee => {
                        switch (type) {
                            case 'Departments':
                                return employee.department === value;
                            case 'Experience Level':
                                return employee.level === value;
                            case 'Skills':
                                return employee.skills.includes(value);
                            default:
                                return true;
                        }
                    });
                });

                this.filteredResults = filtered;
                this.renderResults();
            }

            setupKeyboardShortcuts() {
                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey && e.key === '/') {
                        e.preventDefault();
                        this.searchInput.focus();
                        this.announce('Search field focused');
                    } else if (e.ctrlKey && e.key === 'k') {
                        e.preventDefault();
                        this.clearSearch();
                    }
                });
            }

            handleSearch(query) {
                this.updateStatus('Searching...');
                
                if (!query.trim()) {
                    this.filteredResults = [];
                    this.renderResults();
                    this.updateStatus('Ready');
                    return;
                }

                const results = this.employees.filter(employee => {
                    const searchableText = [
                        employee.name,
                        employee.department,
                        employee.level,
                        ...employee.skills,
                        employee.email
                    ].join(' ').toLowerCase();
                    
                    return searchableText.includes(query.toLowerCase());
                });

                this.filteredResults = results;
                this.selectedResultIndex = -1;
                this.renderResults();
                this.updateSuggestions(query);
                this.announceSearchResults(results.length);
                this.updateStatus(`Found ${results.length} results`);
            }

            performSearch(query = null) {
                const searchTerm = query || this.searchInput.value;
                this.handleSearch(searchTerm);
            }

            handleSearchKeydown(e) {
                const suggestionsVisible = this.suggestionsContainer.style.display !== 'none';
                
                switch (e.key) {
                    case 'ArrowDown':
                        e.preventDefault();
                        if (suggestionsVisible) {
                            this.navigateSuggestions(1);
                        } else {
                            this.navigateResults(1);
                        }
                        break;
                    case 'ArrowUp':
                        e.preventDefault();
                        if (suggestionsVisible) {
                            this.navigateSuggestions(-1);
                        } else {
                            this.navigateResults(-1);
                        }
                        break;
                    case 'Enter':
                        e.preventDefault();
                        if (suggestionsVisible && this.selectedSuggestionIndex >= 0) {
                            this.selectSuggestion(this.selectedSuggestionIndex);
                        } else if (this.selectedResultIndex >= 0) {
                            this.selectResult(this.selectedResultIndex);
                        }
                        break;
                    case 'Escape':
                        if (suggestionsVisible) {
                            this.hideSuggestions();
                        } else {
                            this.clearSearch();
                        }
                        break;
                }
            }

            handleResultsKeydown(e) {
                switch (e.key) {
                    case 'ArrowDown':
                        e.preventDefault();
                        this.navigateResults(1);
                        break;
                    case 'ArrowUp':
                        e.preventDefault();
                        this.navigateResults(-1);
                        break;
                    case 'Enter':
                        e.preventDefault();
                        if (this.selectedResultIndex >= 0) {
                            this.selectResult(this.selectedResultIndex);
                        }
                        break;
                }
            }

            navigateResults(direction) {
                if (this.filteredResults.length === 0) return;

                const newIndex = this.selectedResultIndex + direction;
                
                if (newIndex >= 0 && newIndex < this.filteredResults.length) {
                    this.selectedResultIndex = newIndex;
                    this.highlightResult();
                    this.announceCurrentResult();
                }
            }

            navigateSuggestions(direction) {
                if (this.suggestions.length === 0) return;

                const newIndex = this.selectedSuggestionIndex + direction;
                
                if (newIndex >= -1 && newIndex < this.suggestions.length) {
                    this.selectedSuggestionIndex = newIndex;
                    this.highlightSuggestion();
                    
                    if (newIndex >= 0) {
                        this.searchInput.value = this.suggestions[newIndex];
                        this.announce(`Suggestion: ${this.suggestions[newIndex]}`);
                    }
                }
            }

            selectResult(index) {
                if (index >= 0 && index < this.filteredResults.length) {
                    const employee = this.filteredResults[index];
                    this.announce(`Selected ${employee.name}, ${employee.department} department`);
                }
            }

            selectSuggestion(index) {
                if (index >= 0 && index < this.suggestions.length) {
                    this.searchInput.value = this.suggestions[index];
                    this.hideSuggestions();
                    this.performSearch();
                }
            }

            highlightResult() {
                const resultItems = this.resultsContainer.querySelectorAll('.result-item');
                resultItems.forEach((item, index) => {
                    if (index === this.selectedResultIndex) {
                        item.classList.add('selected');
                        item.focus();
                        item.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                    } else {
                        item.classList.remove('selected');
                    }
                });
            }

            highlightSuggestion() {
                const suggestionItems = this.suggestionsContainer.querySelectorAll('.suggestion-item');
                suggestionItems.forEach((item, index) => {
                    if (index === this.selectedSuggestionIndex) {
                        item.classList.add('highlighted');
                    } else {
                        item.classList.remove('highlighted');
                    }
                });
            }

            updateSuggestions(query) {
                if (!query.trim()) return;

                const suggestions = new Set();
                this.employees.forEach(employee => {
                    if (employee.name.toLowerCase().includes(query.toLowerCase())) {
                        suggestions.add(employee.name);
                    }
                    if (employee.department.toLowerCase().includes(query.toLowerCase())) {
                        suggestions.add(employee.department);
                    }
                    employee.skills.forEach(skill => {
                        if (skill.toLowerCase().includes(query.toLowerCase())) {
                            suggestions.add(skill);
                        }
                    });
                });

                this.suggestions = Array.from(suggestions).slice(0, 5);
                this.renderSuggestions();
            }

            renderSuggestions() {
                if (this.suggestions.length === 0) {
                    this.hideSuggestions();
                    return;
                }

                this.suggestionsContainer.innerHTML = '';
                this.suggestions.forEach((suggestion, index) => {
                    const item = document.createElement('div');
                    item.className = 'suggestion-item';
                    item.textContent = suggestion;
                    item.addEventListener('click', () => this.selectSuggestion(index));
                    this.suggestionsContainer.appendChild(item);
                });
            }

            showSuggestions() {
                if (this.suggestions.length > 0) {
                    this.suggestionsContainer.style.display = 'block';
                    this.searchInput.setAttribute('aria-expanded', 'true');
                }
            }

            hideSuggestions() {
                this.suggestionsContainer.style.display = 'none';
                this.searchInput.setAttribute('aria-expanded', 'false');
                this.selectedSuggestionIndex = -1;
            }

            renderResults() {
                this.resultsContainer.innerHTML = '';
                
                if (this.filteredResults.length === 0) {
                    const noResults = document.createElement('div');
                    noResults.className = 'result-item';
                    noResults.innerHTML = `
                        <div class="result-content">
                            <div class="result-title">No results found</div>
                            <div class="result-description">Try adjusting your search terms or filters</div>
                        </div>
                    `;
                    this.resultsContainer.appendChild(noResults);
                    return;
                }

                this.filteredResults.forEach((employee, index) => {
                    const item = document.createElement('div');
                    item.className = 'result-item';
                    item.tabIndex = 0;
                    item.setAttribute('role', 'option');
                    item.setAttribute('aria-label', `${employee.name}, ${employee.department} department, ${employee.level} level`);
                    
                    item.innerHTML = `
                        <div class="result-icon">${employee.name.charAt(0)}</div>
                        <div class="result-content">
                            <div class="result-title">${employee.name}</div>
                            <div class="result-description">
                                ${employee.department} • ${employee.level} • ${employee.experience}
                            </div>
                        </div>
                        <div class="result-meta">
                            Skills: ${employee.skills.slice(0, 2).join(', ')}
                        </div>
                    `;
                    
                    item.addEventListener('click', () => this.selectResult(index));
                    this.resultsContainer.appendChild(item);
                });

                this.updateResultCountDisplay();
            }

            updateResultCountDisplay() {
                const countDisplay = document.getElementById('result-count-display');
                countDisplay.textContent = `Showing ${this.filteredResults.length} results`;
            }

            clearSearch() {
                this.searchInput.value = '';
                this.filteredResults = [];
                this.selectedResultIndex = -1;
                this.renderResults();
                this.hideSuggestions();
                this.announce('Search cleared');
                this.updateStatus('Ready');
            }

            announceSearchResults(count) {
                const message = count === 1 ? '1 result found' : `${count} results found`;
                this.announce(message);
                document.getElementById('resultCount').textContent = message;
            }

            announceCurrentResult() {
                if (this.selectedResultIndex >= 0 && this.selectedResultIndex < this.filteredResults.length) {
                    const employee = this.filteredResults[this.selectedResultIndex];
                    this.announce(`${employee.name}, ${employee.department}, ${employee.level} level`);
                }
            }

            announceFilterChange(type, value, added) {
                const action = added ? 'added' : 'removed';
                this.announce(`Filter ${action}: ${value} in ${type}`);
            }

            announcePageLoad() {
                setTimeout(() => {
                    this.announce('Employee directory search loaded. Use the search field to find employees by name, department, or skills.');
                }, 1000);
            }

            announceInstructions() {
                const instructions = `
                    Employee directory search instructions:
                    Type in the search field to find employees.
                    Use arrow keys to navigate results.
                    Press Enter to select a result.
                    Use filters to narrow down results.
                    Press Control slash to focus the search field.
                    Press Control K to clear the search.
                `;
                this.announce(instructions);
            }

            updateStatus(message) {
                const statusIndicator = document.getElementById('status-indicator');
                const statusText = document.getElementById('status-text');
                
                statusText.textContent = message;
                statusIndicator.classList.add('show');
                
                setTimeout(() => {
                    statusIndicator.classList.remove('show');
                }, 3000);
                
                document.getElementById('searchStatus').textContent = message;
            }

            announce(message) {
                document.getElementById('searchStatus').textContent = message;
            }

            toggleHighContrast() {
                document.body.classList.toggle('high-contrast');
                const button = event.target;
                button.classList.toggle('active');
                this.announce(document.body.classList.contains('high-contrast') ? 'High contrast enabled' : 'High contrast disabled');
            }

            toggleLargeText() {
                document.body.classList.toggle('large-text');
                const button = event.target;
                button.classList.toggle('active');
                this.announce(document.body.classList.contains('large-text') ? 'Large text enabled' : 'Large text disabled');
            }

            toggleReducedMotion() {
                document.body.classList.toggle('reduced-motion');
                const button = event.target;
                button.classList.toggle('active');
                this.announce(document.body.classList.contains('reduced-motion') ? 'Reduced motion enabled' : 'Reduced motion disabled');
            }

            debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }
        }

        // Initialize the accessibility search system
        const accessibilitySearch = new AccessibilitySearch();

        // Add screen reader only styles
        const srOnlyStyles = document.createElement('style');
        srOnlyStyles.textContent = `
            .sr-only {
                position: absolute;
                left: -10000px;
                top: auto;
                width: 1px;
                height: 1px;
                overflow: hidden;
            }
        `;
        document.head.appendChild(srOnlyStyles);
    </script>
</body>
</html>